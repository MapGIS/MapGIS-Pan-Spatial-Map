define(["exports","./Transforms-70ded1e8","./Matrix2-10a61a55","./RuntimeError-24b14c10","./when-ae2e0b60","./EllipsoidTangentPlane-eed317db","./ComponentDatatype-b7b5db18","./Plane-f7823f4c"],function(a,l,N,t,O,w,y,b){"use strict";function P(a,t){this.center=N.Cartesian3.clone(O.defaultValue(a,N.Cartesian3.ZERO)),this.halfAxes=N.Matrix3.clone(O.defaultValue(t,N.Matrix3.ZERO))}P.packedLength=N.Cartesian3.packedLength+N.Matrix3.packedLength,P.pack=function(a,t,e){return e=O.defaultValue(e,0),N.Cartesian3.pack(a.center,t,e),N.Matrix3.pack(a.halfAxes,t,e+N.Cartesian3.packedLength),t},P.unpack=function(a,t,e){return t=O.defaultValue(t,0),O.defined(e)||(e=new P),N.Cartesian3.unpack(a,t,e.center),N.Matrix3.unpack(a,t+N.Cartesian3.packedLength,e.halfAxes),e};var T=new N.Cartesian3,A=new N.Cartesian3,I=new N.Cartesian3,R=new N.Cartesian3,E=new N.Cartesian3,S=new N.Cartesian3,U=new N.Matrix3,L={unitary:new N.Matrix3,diagonal:new N.Matrix3},m=(P.fromPoints=function(a,t){if(O.defined(t)||(t=new P),O.defined(a)&&0!==a.length){for(var e=a.length,n=N.Cartesian3.clone(a[0],T),r=1;r<e;r++)N.Cartesian3.add(n,a[r],n);var i,s=1/e,o=(N.Cartesian3.multiplyByScalar(n,s,n),0),C=0,c=0,u=0,d=0,l=0;for(r=0;r<e;r++)o+=(i=N.Cartesian3.subtract(a[r],n,A)).x*i.x,C+=i.x*i.y,c+=i.x*i.z,u+=i.y*i.y,d+=i.y*i.z,l+=i.z*i.z;C*=s,c*=s,u*=s,d*=s,l*=s;var h=U,s=(h[0]=o*=s,h[1]=C,h[2]=c,h[3]=C,h[4]=u,h[5]=d,h[6]=c,h[7]=d,h[8]=l,N.Matrix3.computeEigenDecomposition(h,L)),h=N.Matrix3.clone(s.unitary,t.halfAxes),x=N.Matrix3.getColumn(h,0,R),m=N.Matrix3.getColumn(h,1,E),M=N.Matrix3.getColumn(h,2,S),f=-Number.MAX_VALUE,p=-Number.MAX_VALUE,g=-Number.MAX_VALUE,w=Number.MAX_VALUE,y=Number.MAX_VALUE,b=Number.MAX_VALUE;for(r=0;r<e;r++)i=a[r],f=Math.max(N.Cartesian3.dot(x,i),f),p=Math.max(N.Cartesian3.dot(m,i),p),g=Math.max(N.Cartesian3.dot(M,i),g),w=Math.min(N.Cartesian3.dot(x,i),w),y=Math.min(N.Cartesian3.dot(m,i),y),b=Math.min(N.Cartesian3.dot(M,i),b);x=N.Cartesian3.multiplyByScalar(x,.5*(w+f),x),m=N.Cartesian3.multiplyByScalar(m,.5*(y+p),m),M=N.Cartesian3.multiplyByScalar(M,.5*(b+g),M),s=N.Cartesian3.add(x,m,t.center),h=(N.Cartesian3.add(s,M,s),I);h.x=f-w,h.y=p-y,h.z=g-b,N.Cartesian3.multiplyByScalar(h,.5,h),N.Matrix3.multiplyByScale(t.halfAxes,h,t.halfAxes)}else t.halfAxes=N.Matrix3.ZERO,t.center=N.Cartesian3.ZERO;return t},new N.Cartesian3),h=new N.Cartesian3;function z(a,t,e,n,r,i,s,o,C,c,u){var d=(u=O.defined(u)?u:new P).halfAxes;N.Matrix3.setColumn(d,0,t,d),N.Matrix3.setColumn(d,1,e,d),N.Matrix3.setColumn(d,2,n,d);(t=m).x=(r+i)/2,t.y=(s+o)/2,t.z=(C+c)/2;e=h,e.x=(i-r)/2,e.y=(o-s)/2,e.z=(c-C)/2,n=u.center,t=N.Matrix3.multiplyByVector(d,t,t);return N.Cartesian3.add(a,t,n),N.Matrix3.multiplyByScale(d,e,d),u}var B=new N.Cartographic,V=new N.Cartesian3,_=new N.Cartographic,v=new N.Cartographic,k=new N.Cartographic,W=new N.Cartographic,D=new N.Cartographic,X=new N.Cartesian3,q=new N.Cartesian3,j=new N.Cartesian3,Z=new N.Cartesian3,Y=new N.Cartesian3,G=new N.Cartesian2,F=new N.Cartesian2,H=new N.Cartesian2,J=new N.Cartesian2,K=new N.Cartesian2,Q=new N.Cartesian3,$=new N.Cartesian3,aa=new N.Cartesian3,ta=new N.Cartesian3,ea=new N.Cartesian2,na=new N.Cartesian3,ra=new N.Cartesian3,ia=new N.Cartesian3,sa=new b.Plane(N.Cartesian3.UNIT_X,0),M=(P.fromRectangle=function(a,t,e,n,r){var i,s,o,C,c;if(t=O.defaultValue(t,0),e=O.defaultValue(e,0),n=O.defaultValue(n,N.Ellipsoid.WGS84),a.width<=y.CesiumMath.PI)return s=N.Rectangle.center(a,B),x=n.cartographicToCartesian(s,V),i=(x=new w.EllipsoidTangentPlane(x,n)).plane,M=s.longitude,s=a.south<0&&0<a.north?0:s.latitude,c=N.Cartographic.fromRadians(M,a.north,e,_),u=N.Cartographic.fromRadians(a.west,a.north,e,v),s=N.Cartographic.fromRadians(a.west,s,e,k),d=N.Cartographic.fromRadians(a.west,a.south,e,W),M=N.Cartographic.fromRadians(M,a.south,e,D),c=n.cartographicToCartesian(c,X),l=n.cartographicToCartesian(u,q),s=n.cartographicToCartesian(s,j),h=n.cartographicToCartesian(d,Z),M=n.cartographicToCartesian(M,Y),c=x.projectPointToNearestOnPlane(c,G),C=x.projectPointToNearestOnPlane(l,F),s=x.projectPointToNearestOnPlane(s,H),m=x.projectPointToNearestOnPlane(h,J),M=x.projectPointToNearestOnPlane(M,K),o=-(s=Math.min(C.x,s.x,m.x)),C=Math.max(C.y,c.y),c=Math.min(m.y,M.y),u.height=d.height=t,l=n.cartographicToCartesian(u,q),h=n.cartographicToCartesian(d,Z),m=Math.min(b.Plane.getPointDistance(i,l),b.Plane.getPointDistance(i,h)),M=e,z(x.origin,x.xAxis,x.yAxis,x.zAxis,s,o,c,C,m,M,r);var u=0<a.south,d=a.north<0,l=u?a.south:d?a.north:0,h=N.Rectangle.center(a,B).longitude,x=N.Cartesian3.fromRadians(h,l,e,n,Q);x.z=0;var m,M,f=Math.abs(x.x)<y.CesiumMath.EPSILON10&&Math.abs(x.y)<y.CesiumMath.EPSILON10?N.Cartesian3.UNIT_X:N.Cartesian3.normalize(x,$),p=N.Cartesian3.UNIT_Z,g=N.Cartesian3.cross(f,p,aa),h=(i=b.Plane.fromPointNormal(x,f,sa),N.Cartesian3.fromRadians(h+y.CesiumMath.PI_OVER_TWO,l,e,n,ta)),h=(s=-(o=N.Cartesian3.dot(b.Plane.projectPointOntoPlane(i,h,ea),g)),C=N.Cartesian3.fromRadians(0,a.north,d?t:e,n,na).z,c=N.Cartesian3.fromRadians(0,a.south,u?t:e,n,ra).z,N.Cartesian3.fromRadians(a.east,l,e,n,ia));return z(x,g,p,f,s,o,c,C,m=b.Plane.getPointDistance(i,h),M=0,r)},P.clone=function(a,t){if(O.defined(a))return O.defined(t)?(N.Cartesian3.clone(a.center,t.center),N.Matrix3.clone(a.halfAxes,t.halfAxes),t):new P(a.center,a.halfAxes)},P.intersectPlane=function(a,t){var e=a.center,n=t.normal,a=a.halfAxes,r=n.x,i=n.y,s=n.z,r=Math.abs(r*a[N.Matrix3.COLUMN0ROW0]+i*a[N.Matrix3.COLUMN0ROW1]+s*a[N.Matrix3.COLUMN0ROW2])+Math.abs(r*a[N.Matrix3.COLUMN1ROW0]+i*a[N.Matrix3.COLUMN1ROW1]+s*a[N.Matrix3.COLUMN1ROW2])+Math.abs(r*a[N.Matrix3.COLUMN2ROW0]+i*a[N.Matrix3.COLUMN2ROW1]+s*a[N.Matrix3.COLUMN2ROW2]),i=N.Cartesian3.dot(n,e)+t.distance;return i<=-r?l.Intersect.OUTSIDE:r<=i?l.Intersect.INSIDE:l.Intersect.INTERSECTING},new N.Cartesian3),f=new N.Cartesian3,p=new N.Cartesian3,oa=new N.Cartesian3,g=new N.Cartesian3,Ca=new N.Cartesian3,x=(P.distanceSquaredTo=function(a,t){var e,n,r,i,s,t=N.Cartesian3.subtract(t,a.center,m),a=a.halfAxes,o=N.Matrix3.getColumn(a,0,M),C=N.Matrix3.getColumn(a,1,f),a=N.Matrix3.getColumn(a,2,p),c=N.Cartesian3.magnitude(o),u=N.Cartesian3.magnitude(C),d=N.Cartesian3.magnitude(a),l=!0,h=!0,x=!0,l=(0<c?N.Cartesian3.divideByScalar(o,c,o):l=!1,0<u?N.Cartesian3.divideByScalar(C,u,C):h=!1,0<d?N.Cartesian3.divideByScalar(a,d,a):x=!1,!l+!h+!x),h=(1==l?(i=o,n=C,r=a,h?x||(i=a,r=o):(i=C,n=o),e=N.Cartesian3.cross(n,r,g),i===o?o=e:i===C?C=e:i===a&&(a=e)):2==l?(n=o,h?n=C:x&&(n=a),(i=N.Cartesian3.UNIT_Y).equalsEpsilon(n,y.CesiumMath.EPSILON3)&&(i=N.Cartesian3.UNIT_X),r=N.Cartesian3.cross(n,i,oa),N.Cartesian3.normalize(r,r),e=N.Cartesian3.cross(n,r,g),N.Cartesian3.normalize(e,e),n===o?(C=r,a=e):n===C?(a=r,o=e):n===a&&(o=r,C=e)):3==l&&(o=N.Cartesian3.UNIT_X,C=N.Cartesian3.UNIT_Y,a=N.Cartesian3.UNIT_Z),Ca),x=(h.x=N.Cartesian3.dot(t,o),h.y=N.Cartesian3.dot(t,C),h.z=N.Cartesian3.dot(t,a),0);return h.x<-c?x+=(s=h.x+c)*s:h.x>c&&(x+=(s=h.x-c)*s),h.y<-u?x+=(s=h.y+u)*s:h.y>u&&(x+=(s=h.y-u)*s),h.z<-d?x+=(s=h.z+d)*s:h.z>d&&(x+=(s=h.z-d)*s),x},new N.Cartesian3),ca=new N.Cartesian3,e=(P.computePlaneDistances=function(a,t,e,n){O.defined(n)||(n=new l.Interval);var r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,s=a.center,a=a.halfAxes,o=N.Matrix3.getColumn(a,0,M),C=N.Matrix3.getColumn(a,1,f),a=N.Matrix3.getColumn(a,2,p),c=N.Cartesian3.add(o,C,x),u=(N.Cartesian3.add(c,a,c),N.Cartesian3.add(c,s,c),N.Cartesian3.subtract(c,t,ca)),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i);return N.Cartesian3.add(s,o,c),N.Cartesian3.add(c,C,c),N.Cartesian3.subtract(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),N.Cartesian3.add(s,o,c),N.Cartesian3.subtract(c,C,c),N.Cartesian3.add(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),N.Cartesian3.add(s,o,c),N.Cartesian3.subtract(c,C,c),N.Cartesian3.subtract(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),N.Cartesian3.subtract(s,o,c),N.Cartesian3.add(c,C,c),N.Cartesian3.add(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),N.Cartesian3.subtract(s,o,c),N.Cartesian3.add(c,C,c),N.Cartesian3.subtract(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),N.Cartesian3.subtract(s,o,c),N.Cartesian3.subtract(c,C,c),N.Cartesian3.add(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),N.Cartesian3.subtract(s,o,c),N.Cartesian3.subtract(c,C,c),N.Cartesian3.subtract(c,a,c),N.Cartesian3.subtract(c,t,u),d=N.Cartesian3.dot(e,u),r=Math.min(d,r),i=Math.max(d,i),n.start=r,n.stop=i,n},new l.BoundingSphere);P.isOccluded=function(a,t){a=l.BoundingSphere.fromOrientedBoundingBox(a,e);return!t.isBoundingSphereVisible(a)},P.prototype.intersectPlane=function(a){return P.intersectPlane(this,a)},P.prototype.distanceSquaredTo=function(a){return P.distanceSquaredTo(this,a)},P.prototype.computePlaneDistances=function(a,t,e){return P.computePlaneDistances(this,a,t,e)},P.prototype.isOccluded=function(a){return P.isOccluded(this,a)},P.equals=function(a,t){return a===t||O.defined(a)&&O.defined(t)&&N.Cartesian3.equals(a.center,t.center)&&N.Matrix3.equals(a.halfAxes,t.halfAxes)},P.prototype.clone=function(a){return P.clone(this,a)},P.prototype.equals=function(a){return P.equals(this,a)},a.OrientedBoundingBox=P});
