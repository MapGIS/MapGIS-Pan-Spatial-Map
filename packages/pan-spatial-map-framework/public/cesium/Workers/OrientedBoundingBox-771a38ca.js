define(["exports","./Transforms-07a9fab5","./Cartesian2-38b35910","./Check-f996273c","./when-ae2e0b60","./EllipsoidTangentPlane-19622103","./Math-5bbcea10","./Plane-45ad3143"],function(a,b,O,t,P,R,w,y){"use strict";function T(a,t){this.center=O.Cartesian3.clone(P.defaultValue(a,O.Cartesian3.ZERO)),this.halfAxes=b.Matrix3.clone(P.defaultValue(t,b.Matrix3.ZERO))}T.packedLength=O.Cartesian3.packedLength+b.Matrix3.packedLength,T.pack=function(a,t,e){return e=P.defaultValue(e,0),O.Cartesian3.pack(a.center,t,e),b.Matrix3.pack(a.halfAxes,t,e+O.Cartesian3.packedLength),t},T.unpack=function(a,t,e){return t=P.defaultValue(t,0),P.defined(e)||(e=new T),O.Cartesian3.unpack(a,t,e.center),b.Matrix3.unpack(a,t+O.Cartesian3.packedLength,e.halfAxes),e};var E=new O.Cartesian3,S=new O.Cartesian3,U=new O.Cartesian3,L=new O.Cartesian3,z=new O.Cartesian3,B=new O.Cartesian3,V=new b.Matrix3,_={unitary:new b.Matrix3,diagonal:new b.Matrix3},M=(T.fromPoints=function(a,t){if(P.defined(t)||(t=new T),!P.defined(a)||0===a.length)return t.halfAxes=b.Matrix3.ZERO,t.center=O.Cartesian3.ZERO,t;for(var u=a.length,e=O.Cartesian3.clone(a[0],E),n=1;n<u;n++)O.Cartesian3.add(e,a[n],e);var r,i=1/u,l=(O.Cartesian3.multiplyByScalar(e,i,e),0),d=0,h=0,x=0,M=0,m=0;for(n=0;n<u;n++)l+=(r=O.Cartesian3.subtract(a[n],e,S)).x*r.x,d+=r.x*r.y,h+=r.x*r.z,x+=r.y*r.y,M+=r.y*r.z,m+=r.z*r.z;d*=i,h*=i,x*=i,M*=i,m*=i;var s=V,i=(s[0]=l*=i,s[1]=d,s[2]=h,s[3]=d,s[4]=x,s[5]=M,s[6]=h,s[7]=M,s[8]=m,b.Matrix3.computeEigenDecomposition(s,_)),s=b.Matrix3.clone(i.unitary,t.halfAxes),o=b.Matrix3.getColumn(s,0,L),C=b.Matrix3.getColumn(s,1,z),c=b.Matrix3.getColumn(s,2,B),f=-Number.MAX_VALUE,p=-Number.MAX_VALUE,g=-Number.MAX_VALUE,w=Number.MAX_VALUE,y=Number.MAX_VALUE,N=Number.MAX_VALUE;for(n=0;n<u;n++)r=a[n],f=Math.max(O.Cartesian3.dot(o,r),f),p=Math.max(O.Cartesian3.dot(C,r),p),g=Math.max(O.Cartesian3.dot(c,r),g),w=Math.min(O.Cartesian3.dot(o,r),w),y=Math.min(O.Cartesian3.dot(C,r),y),N=Math.min(O.Cartesian3.dot(c,r),N);o=O.Cartesian3.multiplyByScalar(o,.5*(w+f),o),C=O.Cartesian3.multiplyByScalar(C,.5*(y+p),C),c=O.Cartesian3.multiplyByScalar(c,.5*(N+g),c),i=O.Cartesian3.add(o,C,t.center),O.Cartesian3.add(i,c,i),s=U;return s.x=f-w,s.y=p-y,s.z=g-N,O.Cartesian3.multiplyByScalar(s,.5,s),b.Matrix3.multiplyByScale(t.halfAxes,s,t.halfAxes),t},new O.Cartesian3),d=new O.Cartesian3;function N(u,a,t,e,n,r,i,s,o,l,C){var c=(C=P.defined(C)?C:new T).halfAxes;b.Matrix3.setColumn(c,0,a,c),b.Matrix3.setColumn(c,1,t,c),b.Matrix3.setColumn(c,2,e,c);(a=M).x=(n+r)/2,a.y=(i+s)/2,a.z=(o+l)/2;t=d,t.x=(r-n)/2,t.y=(s-i)/2,t.z=(l-o)/2,e=C.center,a=b.Matrix3.multiplyByVector(c,a,a);return O.Cartesian3.add(u,a,e),b.Matrix3.multiplyByScale(c,t,c),C}var A=new O.Cartographic,v=new O.Cartesian3,k=new O.Cartographic,W=new O.Cartographic,X=new O.Cartographic,q=new O.Cartographic,D=new O.Cartographic,j=new O.Cartesian3,I=new O.Cartesian3,Z=new O.Cartesian3,Y=new O.Cartesian3,G=new O.Cartesian3,F=new O.Cartesian2,H=new O.Cartesian2,J=new O.Cartesian2,K=new O.Cartesian2,Q=new O.Cartesian2,$=new O.Cartesian3,aa=new O.Cartesian3,ta=new O.Cartesian3,ea=new O.Cartesian3,na=new O.Cartesian2,ra=new O.Cartesian3,ia=new O.Cartesian3,sa=new O.Cartesian3,oa=new y.Plane(O.Cartesian3.UNIT_X,0),m=(T.fromRectangle=function(a,u,t,e,l){var d,n,h,r,i;if(u=P.defaultValue(u,0),t=P.defaultValue(t,0),e=P.defaultValue(e,O.Ellipsoid.WGS84),a.width<=w.CesiumMath.PI)return n=O.Rectangle.center(a,A),C=e.cartographicToCartesian(n,v),d=(C=new R.EllipsoidTangentPlane(C,e)).plane,c=n.longitude,n=a.south<0&&0<a.north?0:n.latitude,i=O.Cartographic.fromRadians(c,a.north,t,k),x=O.Cartographic.fromRadians(a.west,a.north,t,W),n=O.Cartographic.fromRadians(a.west,n,t,X),M=O.Cartographic.fromRadians(a.west,a.south,t,q),c=O.Cartographic.fromRadians(c,a.south,t,D),i=e.cartographicToCartesian(i,j),s=e.cartographicToCartesian(x,I),n=e.cartographicToCartesian(n,Z),o=e.cartographicToCartesian(M,Y),c=e.cartographicToCartesian(c,G),i=C.projectPointToNearestOnPlane(i,F),r=C.projectPointToNearestOnPlane(s,H),n=C.projectPointToNearestOnPlane(n,J),m=C.projectPointToNearestOnPlane(o,K),c=C.projectPointToNearestOnPlane(c,Q),h=-(n=Math.min(r.x,n.x,m.x)),r=Math.max(r.y,i.y),i=Math.min(m.y,c.y),x.height=M.height=u,s=e.cartographicToCartesian(x,I),o=e.cartographicToCartesian(M,Y),m=Math.min(y.Plane.getPointDistance(d,s),y.Plane.getPointDistance(d,o)),c=t,N(C.origin,C.xAxis,C.yAxis,C.zAxis,n,h,i,r,m,c,l);var x=0<a.south,M=a.north<0,s=x?a.south:M?a.north:0,o=O.Rectangle.center(a,A).longitude,C=O.Cartesian3.fromRadians(o,s,t,e,$);C.z=0;var m,c,f=Math.abs(C.x)<w.CesiumMath.EPSILON10&&Math.abs(C.y)<w.CesiumMath.EPSILON10?O.Cartesian3.UNIT_X:O.Cartesian3.normalize(C,aa),p=O.Cartesian3.UNIT_Z,g=O.Cartesian3.cross(f,p,ta),o=(d=y.Plane.fromPointNormal(C,f,oa),O.Cartesian3.fromRadians(o+w.CesiumMath.PI_OVER_TWO,s,t,e,ea)),o=(n=-(h=O.Cartesian3.dot(y.Plane.projectPointOntoPlane(d,o,na),g)),r=O.Cartesian3.fromRadians(0,a.north,M?u:t,e,ra).z,i=O.Cartesian3.fromRadians(0,a.south,x?u:t,e,ia).z,O.Cartesian3.fromRadians(a.east,s,t,e,sa));return N(C,g,p,f,n,h,i,r,m=y.Plane.getPointDistance(d,o),c=0,l)},T.clone=function(a,t){if(P.defined(a))return P.defined(t)?(O.Cartesian3.clone(a.center,t.center),b.Matrix3.clone(a.halfAxes,t.halfAxes),t):new T(a.center,a.halfAxes)},T.intersectPlane=function(a,t){var e=a.center,n=t.normal,a=a.halfAxes,r=n.x,i=n.y,s=n.z,r=Math.abs(r*a[b.Matrix3.COLUMN0ROW0]+i*a[b.Matrix3.COLUMN0ROW1]+s*a[b.Matrix3.COLUMN0ROW2])+Math.abs(r*a[b.Matrix3.COLUMN1ROW0]+i*a[b.Matrix3.COLUMN1ROW1]+s*a[b.Matrix3.COLUMN1ROW2])+Math.abs(r*a[b.Matrix3.COLUMN2ROW0]+i*a[b.Matrix3.COLUMN2ROW1]+s*a[b.Matrix3.COLUMN2ROW2]),i=O.Cartesian3.dot(n,e)+t.distance;return i<=-r?b.Intersect.OUTSIDE:r<=i?b.Intersect.INSIDE:b.Intersect.INTERSECTING},new O.Cartesian3),f=new O.Cartesian3,p=new O.Cartesian3,g=new O.Cartesian3,Ca=new O.Cartesian3,ca=new O.Cartesian3,h=(T.distanceSquaredTo=function(a,u){var t,e,n,r,i,u=O.Cartesian3.subtract(u,a.center,M),a=a.halfAxes,s=b.Matrix3.getColumn(a,0,m),o=b.Matrix3.getColumn(a,1,f),a=b.Matrix3.getColumn(a,2,p),l=O.Cartesian3.magnitude(s),d=O.Cartesian3.magnitude(o),h=O.Cartesian3.magnitude(a),x=!0,C=!0,c=!0,x=(0<l?O.Cartesian3.divideByScalar(s,l,s):x=!1,0<d?O.Cartesian3.divideByScalar(o,d,o):C=!1,0<h?O.Cartesian3.divideByScalar(a,h,a):c=!1,!x+!C+!c),C=(1==x?(r=s,e=o,n=a,C?c||(r=a,n=s):(r=o,e=s),t=O.Cartesian3.cross(e,n,Ca),r===s?s=t:r===o?o=t:r===a&&(a=t)):2==x?(e=s,C?e=o:c&&(e=a),(r=O.Cartesian3.UNIT_Y).equalsEpsilon(e,w.CesiumMath.EPSILON3)&&(r=O.Cartesian3.UNIT_X),n=O.Cartesian3.cross(e,r,g),O.Cartesian3.normalize(n,n),t=O.Cartesian3.cross(e,n,Ca),O.Cartesian3.normalize(t,t),e===s?(o=n,a=t):e===o?(a=n,s=t):e===a&&(s=n,o=t)):3==x&&(s=O.Cartesian3.UNIT_X,o=O.Cartesian3.UNIT_Y,a=O.Cartesian3.UNIT_Z),ca),c=(C.x=O.Cartesian3.dot(u,s),C.y=O.Cartesian3.dot(u,o),C.z=O.Cartesian3.dot(u,a),0);return C.x<-l?c+=(i=C.x+l)*i:C.x>l&&(c+=(i=C.x-l)*i),C.y<-d?c+=(i=C.y+d)*i:C.y>d&&(c+=(i=C.y-d)*i),C.z<-h?c+=(i=C.z+h)*i:C.z>h&&(c+=(i=C.z-h)*i),c},new O.Cartesian3),x=new O.Cartesian3,e=(T.computePlaneDistances=function(a,t,e,u){P.defined(u)||(u=new b.Interval);var n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=a.center,a=a.halfAxes,s=b.Matrix3.getColumn(a,0,m),l=b.Matrix3.getColumn(a,1,f),a=b.Matrix3.getColumn(a,2,p),o=O.Cartesian3.add(s,l,h),C=(O.Cartesian3.add(o,a,o),O.Cartesian3.add(o,i,o),O.Cartesian3.subtract(o,t,x)),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r);return O.Cartesian3.add(i,s,o),O.Cartesian3.add(o,l,o),O.Cartesian3.subtract(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),O.Cartesian3.add(i,s,o),O.Cartesian3.subtract(o,l,o),O.Cartesian3.add(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),O.Cartesian3.add(i,s,o),O.Cartesian3.subtract(o,l,o),O.Cartesian3.subtract(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),O.Cartesian3.subtract(i,s,o),O.Cartesian3.add(o,l,o),O.Cartesian3.add(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),O.Cartesian3.subtract(i,s,o),O.Cartesian3.add(o,l,o),O.Cartesian3.subtract(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),O.Cartesian3.subtract(i,s,o),O.Cartesian3.subtract(o,l,o),O.Cartesian3.add(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),O.Cartesian3.subtract(i,s,o),O.Cartesian3.subtract(o,l,o),O.Cartesian3.subtract(o,a,o),O.Cartesian3.subtract(o,t,C),c=O.Cartesian3.dot(e,C),n=Math.min(c,n),r=Math.max(c,r),u.start=n,u.stop=r,u},new b.BoundingSphere);T.isOccluded=function(a,t){a=b.BoundingSphere.fromOrientedBoundingBox(a,e);return!t.isBoundingSphereVisible(a)},T.prototype.intersectPlane=function(a){return T.intersectPlane(this,a)},T.prototype.distanceSquaredTo=function(a){return T.distanceSquaredTo(this,a)},T.prototype.computePlaneDistances=function(a,t,e){return T.computePlaneDistances(this,a,t,e)},T.prototype.isOccluded=function(a){return T.isOccluded(this,a)},T.equals=function(a,t){return a===t||P.defined(a)&&P.defined(t)&&O.Cartesian3.equals(a.center,t.center)&&b.Matrix3.equals(a.halfAxes,t.halfAxes)},T.prototype.clone=function(a){return T.clone(this,a)},T.prototype.equals=function(a){return T.equals(this,a)},a.OrientedBoundingBox=T});
