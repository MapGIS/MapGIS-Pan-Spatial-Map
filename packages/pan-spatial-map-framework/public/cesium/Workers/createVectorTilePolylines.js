define(["./Cartesian2-38b35910","./combine-276652d0","./AttributeCompression-25f42564","./Math-5bbcea10","./IndexDatatype-516320ea","./createTaskProcessorWorker","./Check-f996273c","./when-ae2e0b60","./WebGLConstants-35626ea2"],function(S,j,q,_,G,a,e,r,n){"use strict";var W=32767,J=new S.Cartographic,K=new S.Cartesian3;var B=new S.Rectangle,O=new S.Ellipsoid,z=new S.Cartesian3,H={min:void 0,max:void 0};var Y=new S.Cartesian3,Z=new S.Cartesian3,Q=new S.Cartesian3,V=new S.Cartesian3,X=new S.Cartesian3;return a(function(f,p){var a=new Uint16Array(f.positions),d=new Uint16Array(f.widths),C=new Uint32Array(f.counts),b=new Uint16Array(f.batchIds);e=f.packedBuffer,e=new Float64Array(e),n=0,H.min=e[n++],H.max=e[n++],S.Rectangle.unpack(e,2,B),n+=S.Rectangle.packedLength,S.Ellipsoid.unpack(e,n,O),n+=S.Ellipsoid.packedLength,S.Cartesian3.unpack(e,n,z);for(var e=O,h=z,r=function(a,e,f,p,d){for(var r=a.length/3,n=a.subarray(0,r),t=a.subarray(r,2*r),i=a.subarray(2*r,3*r),s=(q.AttributeCompression.zigZagDeltaDecode(n,t,i),new Float64Array(a.length)),o=0;o<r;++o){var u=n[o],c=t[o],C=i[o],u=_.CesiumMath.lerp(e.west,e.east,u/W),c=_.CesiumMath.lerp(e.south,e.north,c/W),C=_.CesiumMath.lerp(f,p,C/W),u=S.Cartographic.fromRadians(u,c,C,J),c=d.cartographicToCartesian(u,K);S.Cartesian3.pack(c,s,3*o)}return s}(a,B,H.min,H.max,e),n=r.length/3,a=4*n-4,w=new Float32Array(3*a),l=new Float32Array(3*a),y=new Float32Array(3*a),k=new Float32Array(2*a),v=new Uint16Array(a),A=0,g=0,m=0,t=0,x=C.length,i=0;i<x;++i){for(var D=C[i],E=d[i],I=b[i],s=0;s<D;++s){0===s?(U=S.Cartesian3.unpack(r,3*t,Y),P=S.Cartesian3.unpack(r,3*(t+1),Z),o=S.Cartesian3.subtract(U,P,Q),S.Cartesian3.add(U,o,o)):o=S.Cartesian3.unpack(r,3*(t+s-1),Q);var o,P,U,u,T=S.Cartesian3.unpack(r,3*(t+s),V);s===D-1?(P=S.Cartesian3.unpack(r,3*(t+D-1),Y),U=S.Cartesian3.unpack(r,3*(t+D-2),Z),u=S.Cartesian3.subtract(P,U,X),S.Cartesian3.add(P,u,u)):u=S.Cartesian3.unpack(r,3*(t+s+1),X),S.Cartesian3.subtract(o,h,o),S.Cartesian3.subtract(T,h,T),S.Cartesian3.subtract(u,h,u);for(var F=s===D-1?2:4,N=0===s?2:0;N<F;++N){S.Cartesian3.pack(T,w,A),S.Cartesian3.pack(o,l,A),S.Cartesian3.pack(u,y,A),A+=3;var R=N-2<0?-1:1;k[g++]=N%2*2-1,k[g++]=R*E,v[m++]=I}}t+=D}var c=G.IndexDatatype.createTypedArray(a,6*n-6),M=0,L=0,x=n-1;for(i=0;i<x;++i)c[L++]=M,c[L++]=M+2,c[L++]=M+1,c[L++]=M+1,c[L++]=M+2,c[L++]=M+3,M+=4;return p.push(w.buffer,l.buffer,y.buffer),p.push(k.buffer,v.buffer,c.buffer),e={indexDatatype:2===c.BYTES_PER_ELEMENT?G.IndexDatatype.UNSIGNED_SHORT:G.IndexDatatype.UNSIGNED_INT,currentPositions:w.buffer,previousPositions:l.buffer,nextPositions:y.buffer,expandAndWidth:k.buffer,batchIds:v.buffer,indices:c.buffer},f.keepDecodedPositions&&(a=function(a){for(var e=a.length,r=new Uint32Array(e+1),n=0,t=0;t<e;++t)r[t]=n,n+=a[t];return r[e]=n,r}(C),p.push(r.buffer,a.buffer),e=j.combine(e,{decodedPositions:r.buffer,decodedPositionOffsets:a.buffer})),e})});
