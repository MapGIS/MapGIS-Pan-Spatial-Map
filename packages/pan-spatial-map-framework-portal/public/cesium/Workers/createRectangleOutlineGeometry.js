define(["./when-ae2e0b60","./Cartesian2-38b35910","./GeometryOffsetAttribute-b02d5bb9","./Transforms-07a9fab5","./ComponentDatatype-e44126e4","./Check-f996273c","./GeometryAttribute-586bf52c","./GeometryAttributes-5ce4955a","./IndexDatatype-516320ea","./Math-5bbcea10","./PolygonPipeline-06aa4301","./RectangleGeometryLibrary-6b59569e","./combine-276652d0","./RuntimeError-ac2797b4","./WebGLConstants-35626ea2","./EllipsoidRhumbLine-af7b5ebe"],function(p,s,c,d,m,e,_,A,G,g,y,E,t,i,a,n){"use strict";var b=new d.BoundingSphere,v=new d.BoundingSphere,R=new s.Cartesian3,P=new s.Rectangle;function w(p,e){var t,i=p._ellipsoid,a=e.height,c=e.width,p=e.northCap,d=e.southCap,n=a,g=2,f=0,h=4,r=(p&&(--g,--n,f+=1,h-=2),d&&(--g,--n,f+=1,h-=2),f+=g*c+2*n-h,new Float64Array(3*f)),o=0,l=0,u=R;if(p)E.RectangleGeometryLibrary.computePosition(e,i,!1,l,0,u),r[o++]=u.x,r[o++]=u.y,r[o++]=u.z;else for(t=0;t<c;t++)E.RectangleGeometryLibrary.computePosition(e,i,!1,l,t,u),r[o++]=u.x,r[o++]=u.y,r[o++]=u.z;for(t=c-1,l=1;l<a;l++)E.RectangleGeometryLibrary.computePosition(e,i,!1,l,t,u),r[o++]=u.x,r[o++]=u.y,r[o++]=u.z;if(l=a-1,!d)for(t=c-2;0<=t;t--)E.RectangleGeometryLibrary.computePosition(e,i,!1,l,t,u),r[o++]=u.x,r[o++]=u.y,r[o++]=u.z;for(t=0,l=a-2;0<l;l--)E.RectangleGeometryLibrary.computePosition(e,i,!1,l,t,u),r[o++]=u.x,r[o++]=u.y,r[o++]=u.z;for(var g=r.length/3*2,s=G.IndexDatatype.createTypedArray(r.length/3,g),y=0,b=0;b<r.length/3-1;b++)s[y++]=b,s[y++]=b+1;s[y++]=r.length/3-1,s[y++]=0;n=new _.Geometry({attributes:new A.GeometryAttributes,primitiveType:_.PrimitiveType.LINES});return n.attributes.position=new _.GeometryAttribute({componentDatatype:m.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:r}),n.indices=s,n}function f(e){var t=(e=p.defaultValue(e,p.defaultValue.EMPTY_OBJECT)).rectangle,i=p.defaultValue(e.granularity,g.CesiumMath.RADIANS_PER_DEGREE),a=p.defaultValue(e.ellipsoid,s.Ellipsoid.WGS84),n=p.defaultValue(e.rotation,0),r=p.defaultValue(e.height,0),o=p.defaultValue(e.extrudedHeight,r);this._rectangle=s.Rectangle.clone(t),this._granularity=i,this._ellipsoid=a,this._surfaceHeight=Math.max(r,o),this._rotation=n,this._extrudedHeight=Math.min(r,o),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}f.packedLength=s.Rectangle.packedLength+s.Ellipsoid.packedLength+5,f.pack=function(e,t,i){return i=p.defaultValue(i,0),s.Rectangle.pack(e._rectangle,t,i),i+=s.Rectangle.packedLength,s.Ellipsoid.pack(e._ellipsoid,t,i),i+=s.Ellipsoid.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=p.defaultValue(e._offsetAttribute,-1),t};var L=new s.Rectangle,C=s.Ellipsoid.clone(s.Ellipsoid.UNIT_SPHERE),h={rectangle:L,ellipsoid:C,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0},D=(f.unpack=function(e,t,i){t=p.defaultValue(t,0);var a=s.Rectangle.unpack(e,t,L),n=(t+=s.Rectangle.packedLength,s.Ellipsoid.unpack(e,t,C)),r=(t+=s.Ellipsoid.packedLength,e[t++]),o=e[t++],l=e[t++],u=e[t++],e=e[t];return p.defined(i)?(i._rectangle=s.Rectangle.clone(a,i._rectangle),i._ellipsoid=s.Ellipsoid.clone(n,i._ellipsoid),i._surfaceHeight=o,i._rotation=l,i._extrudedHeight=u,i._offsetAttribute=-1===e?void 0:e,i):(h.granularity=r,h.height=o,h.rotation=l,h.extrudedHeight=u,h.offsetAttribute=-1===e?void 0:e,new f(h))},new s.Cartographic);return f.createGeometry=function(e){var t,i,a,n,r,o,l=e._rectangle,u=e._ellipsoid,s=E.RectangleGeometryLibrary.computeOptions(l,e._granularity,e._rotation,0,P,D);if(!g.CesiumMath.equalsEpsilon(l.north,l.south,g.CesiumMath.EPSILON10)&&!g.CesiumMath.equalsEpsilon(l.east,l.west,g.CesiumMath.EPSILON10))return t=e._surfaceHeight,n=e._extrudedHeight,a=!g.CesiumMath.equalsEpsilon(t,n,0,g.CesiumMath.EPSILON2)?(i=function(e,t){for(var i=e._surfaceHeight,a=e._extrudedHeight,n=e._ellipsoid,e=w(e,t),p=t.height,c=t.width,r=(i=y.PolygonPipeline.scaleToGeodeticHeight(e.attributes.position.values,i,n,!1)).length,o=new Float64Array(2*r),i=(o.set(i),y.PolygonPipeline.scaleToGeodeticHeight(e.attributes.position.values,a,n)),a=(o.set(i,r),e.attributes.position.values=o,t.northCap),n=t.southCap,i=4,t=(a&&--i,n&&--i,2*(o.length/3+i)),l=G.IndexDatatype.createTypedArray(o.length/3,t),r=o.length/6,u=0,s=0;s<r-1;s++)l[u++]=s,l[u++]=s+1,l[u++]=s+r,l[u++]=s+r+1;return l[u++]=r-1,l[u++]=0,l[u++]=r+r-1,l[u++]=r,l[u++]=0,l[u++]=r,t=a?p-1:(l[u++]=i=c-1,l[u++]=i+r,c+p-2),l[u++]=t,l[u++]=t+r,n||(l[u++]=o=c+t-1,l[u]=o+r),e.indices=l,e}(e,s),p.defined(e._offsetAttribute)&&(r=i.attributes.position.values.length/3,a=new Uint8Array(r),a=e._offsetAttribute===c.GeometryOffsetAttribute.TOP?c.arrayFill(a,1,0,r/2):(o=e._offsetAttribute===c.GeometryOffsetAttribute.NONE?0:1,c.arrayFill(a,o)),i.attributes.applyOffset=new _.GeometryAttribute({componentDatatype:m.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:a})),r=d.BoundingSphere.fromRectangle3D(l,u,t,v),a=d.BoundingSphere.fromRectangle3D(l,u,n,b),d.BoundingSphere.union(r,a)):((i=w(e,s)).attributes.position.values=y.PolygonPipeline.scaleToGeodeticHeight(i.attributes.position.values,t,u,!1),p.defined(e._offsetAttribute)&&(n=i.attributes.position.values.length,r=new Uint8Array(n/3),o=e._offsetAttribute===c.GeometryOffsetAttribute.NONE?0:1,c.arrayFill(r,o),i.attributes.applyOffset=new _.GeometryAttribute({componentDatatype:m.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:r})),d.BoundingSphere.fromRectangle3D(l,u,t)),new _.Geometry({attributes:i.attributes,indices:i.indices,primitiveType:_.PrimitiveType.LINES,boundingSphere:a,offsetAttribute:e._offsetAttribute})},function(e,t){return(e=p.defined(t)?f.unpack(e,t):e)._ellipsoid=s.Ellipsoid.clone(e._ellipsoid),e._rectangle=s.Rectangle.clone(e._rectangle),f.createGeometry(e)}});
